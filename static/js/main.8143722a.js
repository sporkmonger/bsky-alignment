(()=>{"use strict";var e={8782:(e,t,r)=>{r.r(t),r.d(t,{default:()=>z});var n=r(4942),i=r(5861),o=r(885),a=r(2376),s=r(9526),c=r(1133),l=r(746),u=r(7315),f=r(4392),d=r(4567),p=r(8198);function h(e,t){var r=(0,s.useState)(t),n=(0,o.default)(r,2),i=n[0],a=n[1];(0,s.useEffect)((function(){var t=localStorage.getItem(e);t&&a(JSON.parse(t))}),[]);return[i,function(t){localStorage.setItem(e,JSON.stringify(t)),a(t)}]}var v=r(9233),g=r(3497),y=r(5693),w=r(3292),b=r(7557),m=l.default.create({label:{paddingVertical:5,fontSize:16,fontWeight:"bold",color:"#000"},input:{borderStyle:"solid",borderWidth:1,borderRadius:5,paddingVertical:5,paddingLeft:5,fontSize:16,height:40,color:"#000"}});const k=function(e){var t=(0,s.useState)(""),r=(0,o.default)(t,2),n=r[0],i=r[1],a=(0,s.useState)(""),c=(0,o.default)(a,2),l=c[0],u=c[1],f=(0,p.useForm)().handleSubmit;return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(w.default,{style:"auto"}),(0,b.jsx)(v.default,{children:"Don't enter credentials into the wrong website, but I'm just a sign, not a cop."}),(0,b.jsx)(v.default,{style:m.label,children:"BlueSky ID"}),(0,b.jsx)(g.default,{autoCapitalize:"none",style:m.input,value:n,onChangeText:function(e){return i(e)}}),(0,b.jsx)(v.default,{style:m.label,children:"BlueSky Password"}),(0,b.jsx)(g.default,{autoCapitalize:"none",style:[m.input,{marginBottom:8}],secureTextEntry:!0,value:l,onChangeText:function(e){return u(e)}}),(0,b.jsx)(y.default,{title:"Submit",onPress:f((function(){e.onSubmit({identifier:n,password:l})}))})]})};var j=l.default.create({identifier:{paddingVertical:12,fontSize:20,fontWeight:"bold",color:"#000"}});const x=function(e){var t=(0,p.useForm)().handleSubmit;return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(w.default,{style:"auto"}),(0,b.jsxs)(v.default,{style:j.identifier,children:["@",e.identifier]}),(0,b.jsx)(y.default,{title:"Log Out",onPress:t((function(){e.onSubmit()}))})]})};var S=r(6834),O=r(7301),_=r(5671),P=r(3144),C=function(e){return e[e.Trusted=0]="Trusted",e[e.Accepted=1]="Accepted",e[e.Suspected=2]="Suspected",e[e.Restricted=3]="Restricted",e}({}),F=function(){function e(t,r,n){(0,_.default)(this,e),this.accept=t,this.restrict=r,this.unknown=n}return(0,P.default)(e,[{key:"pignistic",value:function(){return new e(this.accept+this.unknown/2,this.restrict+this.unknown/2,0)}},{key:"outcome",value:function(e,t,r){var n=this.pignistic();if(e>t||t>r)throw"threshold out-of-order";if(e<=0||e>=1)throw"threshold out-of-range";if(t<=0||t>=1)throw"threshold out-of-range";if(r<=0||r>=1)throw"threshold out-of-range";return n.restrict<=e?C.Trusted:n.restrict<t?C.Accepted:n.restrict>=r?C.Restricted:C.Suspected}},{key:"clamp",value:function(){return this.clamp_min_unknown(0)}},{key:"clamp_min_unknown",value:function(t){var r=this.accept,n=this.restrict,i=this.unknown;return r<0?r=0:r>1&&(r=1),n<0?n=0:n>1&&(n=1),i<0?i=0:i>1&&(i=1),i<t&&(i=t),new e(r,n,i)}},{key:"fill_unknown",value:function(){var t;return t=this.accept+this.restrict+this.unknown<1?1-this.accept-this.restrict:this.unknown,new e(this.accept,this.restrict,t)}},{key:"scale",value:function(){return this.scale_min_unknown(0)}},{key:"scale_min_unknown",value:function(t){var r=this.fill_unknown().clamp(),n=r.accept+r.restrict+r.unknown,i=r.accept,o=r.restrict,a=r.unknown;if(n>0&&(i/=n,o/=n,a/=n),a<t&&(a=t),(n=1-a)>0){var s=i+o;i=n*(i/s),o=n*(o/s)}return new e(i,o,a)}},{key:"weight",value:function(t){return new e(this.accept*t,this.restrict*t,0).scale()}}],[{key:"pairwise_combine",value:function(t,r){var n=t.accept*r.restrict+t.restrict*r.accept;return new e((t.accept*r.accept+t.accept*r.unknown+t.unknown*r.accept)/(1-n),(t.restrict*r.restrict+t.restrict*r.unknown+t.unknown*r.restrict)/(1-n),t.unknown*r.unknown/(1-n))}},{key:"combine_conjunctive",value:function(t){var r=new e(0,0,1);for(var n of t)r=e.pairwise_combine(r,n);return r}},{key:"combine_murphy",value:function(t){var r=0,n=0,i=0,o=0;for(var a of t)r+=a.accept,n+=a.restrict,i+=a.unknown,o+=1;for(var s=new e(r/o,n/o,i/o),c=new e(0,0,1),l=0;l<o;l++)c=e.pairwise_combine(c,s);return c}}]),e}(),T=function(e,t,r,n){var i=t.get(e.handle)||{profile:e,decisions:[]};i.decisions.push(new F(r?1:0,r?0:1,0).weight(n)),t.set(i.profile.handle,i)},B=function(){var e=(0,i.default)((function*(e,t){var r=new Map;console.log("making expensive api calls... sorry BlueSky folks!");for(var n,i=[],o=0;o<10;o++){var a=yield e.getFollows({actor:t,cursor:n});if(!a.success)break;if(i=i.concat(a.data.follows),!a.data.cursor||0===a.data.follows.length)break;n=a.data.cursor}for(var s of i){T(s,r,!0,.75);var c=yield e.getFollows({actor:s.did});if(c.success)for(var l of c.data.follows)T(l,r,!0,.1);var u=yield e.api.com.atproto.repo.listRecords({repo:s.did,collection:"app.bsky.graph.block"});if(u.success){var f=u.data.records.map((function(e){return e.value.subject}));if(f.length>0){var d=yield e.getProfiles({actors:f});if(d.success)for(var p of d.data.profiles)T(p,r,!1,.4)}}}for(var h,v=[],g=0;g<5;g++){var y=yield e.getFollowers({actor:t,cursor:h});if(!y.success)break;if(v=v.concat(y.data.followers),!y.data.cursor||0===y.data.followers.length)break;h=y.data.cursor}for(var w of v)T(w,r,!0,0);for(var b,m=[],k=0;k<10;k++){var j=yield e.api.app.bsky.graph.getBlocks({cursor:b});if(!j.success)break;if(m=m.concat(j.data.blocks),!j.data.cursor||0===j.data.blocks.length)break;b=j.data.cursor}for(var x of m)T(x,r,!1,1);for(var S,O=[],_=0;_<10;_++){var P=yield e.api.app.bsky.graph.getMutes({cursor:S});if(!P.success)break;if(O=O.concat(P.data.mutes),!P.data.cursor||0===P.data.mutes.length)break;S=P.data.cursor}for(var C of O)T(C,r,!1,.5);for(var B,D=[],E=0;E<3;E++){var R=yield e.getSuggestions({cursor:B});if(!R.success)break;if(D=D.concat(R.data.actors),!R.data.cursor||0===R.data.actors.length)break;B=R.data.cursor}for(var z of D)T(z,r,!0,0);return r.forEach((function(e){e.profile.viewer&&e.profile.viewer.blockedBy&&e.decisions.push(new F(0,.3,.7))})),console.log("expensive api calls done"),r}));return function(t,r){return e.apply(this,arguments)}}(),D=l.default.create({container:{marginVertical:8},avatar:{borderRadius:20,height:40,width:40},profile:{alignItems:"stretch",marginTop:8,marginBottom:10,padding:12,borderColor:"#e0d9d9",borderWidth:1,borderRadius:8,display:"flex",flexBasis:"auto",flexDirection:"row",flexShrink:0},nameContainer:{paddingHorizontal:8,flexGrow:1,flexShrink:1,flexBasis:"0%"},profileDisplayName:{fontSize:16,fontWeight:"bold"},profileHandle:{fontSize:15,color:"#545664"}});const E=function(e){var t=h("@subjects",null),r=(0,o.default)(t,2),n=r[0],a=r[1];return(0,s.useEffect)((function(){e.agent&&e.identifier&&!n&&B(e.agent,e.identifier).then(function(){var t=(0,i.default)((function*(t){!function(e){e.forEach((function(e){e.pignistic=F.combine_murphy(e.decisions).pignistic().accept}))}(t),function(e){e.forEach((function(t,r){(0==t.decisions.length||t.decisions.every((function(e){return e.unknown>.99})))&&e.delete(r)}))}(t),e.identifier&&t.delete(e.identifier);var r=[];t.forEach((function(e){r.push(e)})),r.sort((function(e,t){return(t.pignistic||0)-(e.pignistic||0)})),a(r)}));return function(e){return t.apply(this,arguments)}}())})),(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(w.default,{style:"auto"}),(0,b.jsx)(c.default,{style:D.container,children:n?n.map((function(e){return(0,b.jsxs)(c.default,{style:D.profile,children:[(0,b.jsx)(c.default,{children:e.profile.avatar?(0,b.jsx)(S.default,{style:D.avatar,source:{uri:e.profile.avatar,height:40,width:40}}):(0,b.jsxs)("svg",{width:"40",height:"40",viewBox:"0 0 24 24",fill:"none",stroke:"none",children:[(0,b.jsx)("circle",{cx:"12",cy:"12",r:"12",fill:"#0070ff"}),(0,b.jsx)("circle",{cx:"12",cy:"9.5",r:"3.5",fill:"#fff"}),(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",fill:"#fff",d:"M 12.058 22.784 C 9.422 22.784 7.007 21.836 5.137 20.262 C 5.667 17.988 8.534 16.25 11.99 16.25 C 15.494 16.25 18.391 18.036 18.864 20.357 C 17.01 21.874 14.64 22.784 12.058 22.784 Z"})]})}),(0,b.jsxs)(c.default,{style:D.nameContainer,children:[(0,b.jsx)(v.default,{onPress:function(){return O.default.openURL("https://staging.bsky.app/profile/"+e.profile.handle)},role:"link",style:D.profileDisplayName,children:e.profile.displayName}),(0,b.jsxs)(v.default,{onPress:function(){return O.default.openURL("https://staging.bsky.app/profile/"+e.profile.handle)},role:"link",style:D.profileHandle,children:["@",e.profile.handle]})]}),(0,b.jsx)(v.default,{children:(e.pignistic||0).toLocaleString(void 0,{maximumFractionDigits:2})})]},e.profile.handle||e.profile.did)})):(0,b.jsx)(v.default,{children:"Trying your patience... slowly fetching data from your graph..."})})]})};function R(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function z(){var e=(0,s.useRef)(new a.BskyAgent({service:"https://bsky.social"})).current,t=h("@loginResponseData",null),r=(0,o.default)(t,2),l=r[0],v=r[1],g=null==l?void 0:l.handle,y=null!=l&&l.accessJwt?d.decodeJwt(l.accessJwt):null,w=null==y?void 0:y.exp,m=w?1e3*w-Date.now():null;(0,s.useEffect)((function(){if(m){var e=setTimeout((function(){v(null)}),Math.max(m,0));return function(){return clearTimeout(e)}}}),[m]),(0,s.useEffect)((function(){l&&!e.session&&(console.log("resuming session"),e.resumeSession(l))}),[l]);var j=(0,s.useState)(!!g),S=(0,o.default)(j,2),O=(S[0],S[1],(0,p.useForm)()),_=(O.handleSubmit,O.register,O.setValue,function(){var t=(0,i.default)((function*(t){e.login({identifier:t.identifier,password:t.password}).then(function(){var e=(0,i.default)((function*(e){e.success?v(function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?R(Object(r),!0).forEach((function(t){(0,n.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):R(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},e.data)):v(null)}));return function(t){return e.apply(this,arguments)}}()).catch((function(e){v(null),console.log(e.message)}))}));return function(e){return t.apply(this,arguments)}}()),P=function(){var e=(0,i.default)((function*(){v(null)}));return function(){return e.apply(this,arguments)}}();return(0,b.jsx)(f.SafeAreaProvider,{children:(0,b.jsx)(c.default,{style:M.container,children:(0,b.jsx)(u.KeyboardAwareScrollView,{contentContainerStyle:M.innerContainer,children:g?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(x,{onSubmit:P,identifier:g}),(0,b.jsx)(E,{agent:e,identifier:g})]}):(0,b.jsx)(k,{onSubmit:_})})})})}var M=l.default.create({container:{flex:1,backgroundColor:"#fff",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif'},innerContainer:{padding:8,flex:1}})}},t={};function r(n){var i=t[n];if(void 0!==i)return i.exports;var o=t[n]={exports:{}};return e[n](o,o.exports,r),o.exports}r.m=e,(()=>{var e=[];r.O=(t,n,i,o)=>{if(!n){var a=1/0;for(u=0;u<e.length;u++){for(var[n,i,o]=e[u],s=!0,c=0;c<n.length;c++)(!1&o||a>=o)&&Object.keys(r.O).every((e=>r.O[e](n[c])))?n.splice(c--,1):(s=!1,o<a&&(a=o));if(s){e.splice(u--,1);var l=i();void 0!==l&&(t=l)}}return t}o=o||0;for(var u=e.length;u>0&&e[u-1][2]>o;u--)e[u]=e[u-1];e[u]=[n,i,o]}})(),r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e={179:0};r.O.j=t=>0===e[t];var t=(t,n)=>{var i,o,[a,s,c]=n,l=0;if(a.some((t=>0!==e[t]))){for(i in s)r.o(s,i)&&(r.m[i]=s[i]);if(c)var u=c(r)}for(t&&t(n);l<a.length;l++)o=a[l],r.o(e,o)&&e[o]&&e[o][0](),e[o]=0;return r.O(u)},n=self.webpackChunkweb=self.webpackChunkweb||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})();var n=r.O(void 0,[330],(()=>r(9484)));n=r.O(n)})();
//# sourceMappingURL=main.8143722a.js.map